---
title: "'potools' package"
author: "Casey Youngflesh"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{potools}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Intro

`potools` is an R package used to manipulate and summarize MCMC output. MCMC output may be derived from Bayesian model output fit with JAGS or other MCMC samplers.

The package currently contains four functions:

- `posummary` - summarize MCMC output for particular parameters of interest
- `potrace` - create trace plotsMCMC chains for particular parameters of interest
- `pochains` - easily extract posterior chains from MCMC output for particular parameters of interest
- `poplot` - create caterpillar plots from MCMC output for particular parameters of interest
- `denplot` - create density strip plot from MCMC output for particular parameters of interest

While several packages currently exist to evaluate MCMC output, they do not support simple subsetting of model parameters and/or do not provide an option to properly visualize MCMC output, particularly with large numbers of parameters. `potools` was designed to perform key functions for MCMC analysis using minimal code, in order to free up time/brainpower for interpretation of analysis results. 


&nbsp;


## posummary

`posummary` is used to output summary information from MCMC output. This function accepts `mcmc.list` objects, `R2jags` model output, and matrices of MCMC output (one chain per column).

```{r, message=FALSE}
library(potools)

data(MCMC_data)

posummary(MCMC_data)
```

&nbsp;

Specific parameters can be specified to subset summary information. Partial names may be used to specify any parameter containing that name. For instance, for all `beta` parameters.

```{r}
posummary(MCMC_data, params = 'beta')
```

&nbsp;

Individual parameters can also be specified.

```{r}
posummary(MCMC_data, params = 'beta[1]')
```

&nbsp;

&nbsp;

## potrace

`potrace` is used to create trace and density plots for MCMC output. Particular parameters can also be specified, as with `posummary`.

```{r, fig.width=5, fig.height=6}
potrace(MCMC_data, params = c('beta[1]', 'beta[2]', 'beta[3]'))
```

&nbsp;


Trace plots can also be output to pdf format. This is recommended for large numbers of parameters, as output to pdf makes for quicker browsing compared to browsing within the R GUI. pdf document will be output to the current working directory by default, but another directory can be specified.

```{r, eval=FALSE}
potrace(MCMC_data, pdf = TRUE, filename = 'MYpdf', wd = 'DIRECTORY HERE')
```

&nbsp;


## pochains

`pochains` is used to extract MCMC chains from MCMC objects. Chains can then be manipulated directly. Particular parameters can be specified as with other functions.

```{r}
ex <- pochains(MCMC_data, params = 'beta')

#extract mean values for each parameter
apply(ex, 2, mean)
```

&nbsp;


## poplot

`poplot` is used to create caterpillar plots from MCMC ouput. Points represent posterior medians. Parameters where 50% credible intervals overlap 0 are indicated by 'open' circles. Parameters which 50 percent credible intervals DO NOT overlap 0 AND 95 percent credible intervals DO overlap 0 are indicated by 'closed' grey circles. Parameters which 95 percent credible intervals DO NOT overlap 0 are indicated by 'closed' black circles. Thick lines represent 50 percent credible intervals while thin lines represent 95 percent credible intervals.

As with the other functions in the package, particular parameters of interest can be specified.

```{r, fig.width=5, fig.height=6}
poplot(MCMC_data, params = 'beta')
```


`ref_vis = FALSE` can be used to disable this feature. All median dots will be represented as 'closed' black circles.

```{r, fig.width=5, fig.height=6}
poplot(MCMC_data, params = 'beta', ref_vis = FALSE)
```

&nbsp;

**For more information see `?poplot`**

&nbsp;

## denplot

`denplot` is used to plot density strips from MCMC output. Black ticks are used to specify posterior mean or median (depending on input for `centrality` argument), while grey ticks specify credible intervals (95% CI by default).

```{r, fig.width=5, fig.height=6}
denplot(MCMC_data, labels = NULL)
```

&nbsp;

&nbsp;

Specific parameters can be specified.

```{r, fig.width=5, fig.height=6}
denplot(MCMC_data, params = 'beta')
```

&nbsp;


Parameters can be ranked by posterior mean (or median) estimates using the `rank` argument.

```{r, fig.width=5, fig.height=6}
denplot(MCMC_data, params = 'beta', rank = TRUE)
```

&nbsp;

Color can be added using the `colors` argument. If colors are specified, there must be an input for each parameter to be plotted (i.e., the vector length of colors must match the number of parameters to be plotted).

```{r, fig.width=5, fig.height=6}
#use ggplot colors
n <- NCOL(pochains(MCMC_data, params = 'beta'))
hues <- seq(15, 375, length = n + 1)
ggcolors <- hcl(h = hues, l = 65, c = 100)[1:n]

#plot
denplot(MCMC_data, params = 'beta', colors = ggcolors)
```


&nbsp;

A vertical guideline at 0 is plotted by default, but can be removed with `ref_line = NULL`. Multiple guidelines can be plotted by concatenating argument input.

Graphical parameters for x-axis limitation, axis labels, title, guidline thickness, density bar height, density bar tick height and width, and credible interval tick color can also be specified.

```{r, fig.width=5, fig.height=6}
denplot(MCMC_data, params = c('alpha[4]', 'beta[4]', 'gamma[7]'), 
       ref_line = c(-20, 0, 20, 40),
       ref_line_width = 3,
       xlim = c(-50, 25),
       xlab = 'Posterior estimates',
       main = 'potools plot',
       labels = c('An alpha parameter', 'A beta parameter', 'A gamma parameter'), 
       dbar_height = 0.6,
       dbar_t_height = 0.7,
       dbar_t_width = 5,
       CI_t_color = 'grey99')
```

&nbsp;

**For more information see `?denplot`**

&nbsp;

&nbsp;
